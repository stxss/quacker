<!DOCTYPE html >
<html data-controller="theme" class="preload">
  <head>
    <title>OdinTwitter</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= javascript_include_tag "/assets/builds/application", "data-turbo-track": "reload", defer: true %>
    <%= stylesheet_link_tag "/assets/builds/application", "data-turbo-track": "reload" %>
  </head>

  <body class="h-screen bg-background text-text flex justify-center gap-4">
    <%= turbo_frame_tag "modal" %>

    <div id="flash" class="flash">
      <%= render "layouts/flash" %>
    </div>

    <div class="access-buttons relative top-24 flex flex-col gap-64 w-56 transition-colors duration-500">
      <% if current_user %>
        <div class="access-buttons flex flex-col gap-4 text-xl">
          <div class="home py-2 px-4 rounded-full hover:bg-slate-300"><%= link_to "Home", root_path %></div>
          <div class="search py-2 px-4 rounded-full hover:bg-slate-300"><%= link_to "Search", search_path %></div>
          <div class="explore py-2 px-4 rounded-full hover:bg-slate-300"><%= link_to "Explore" %></div>
          <div class="notifications py-2 px-4 rounded-full hover:bg-slate-300"><%= link_to "Notifications", notifications_path %></div>
          <div class="messages py-2 px-4 rounded-full hover:bg-slate-300"><%= link_to "Messages", messages_path %></div>
          <div class="bookmarks py-2 px-4 rounded-full hover:bg-slate-300"><%= link_to "Bookmarks", bookmarks_path %></div>
          <div class="profile py-2 px-4 rounded-full hover:bg-slate-300"><%= link_to "Profile", username_path(current_user.username) %></div>
          <div class="settings py-2 px-4 rounded-full hover:bg-slate-300"><%= link_to "Settings", settings_account_path(user_id: current_user.id) %></div>

          <%= turbo_frame_tag "button", data: { turbo_permanent: true } do %>
            <div class="compose bg-primary hover:bg-brightness-125 text-white font-bold py-2 px-4 rounded-full text-center"><%= link_to "Compose", new_tweet_path, data: {turbo_frame: "modal", turbo_action: :advance} %></div>
          <% end %>
        </div>

        <div>
          <% if current_user.passive_follows.exists?(is_request: true) %>
            <div class="follow-requests"><%= link_to "Follow Requests", notifications_follow_request_path %></div>
          <% end %>

          <div>Logged in as <%= current_user.username if current_user %></div>
          <%= button_to "Sign out", destroy_user_session_path, method: :delete, class: "bg-primary hover:brightness-125 text-white font-bold py-2 px-4 rounded-full" %>
        </div>
      <% end %>
    </div>

    <%= yield %>

    <div>
      <div class="theme-toggle cursor-pointer relative top-2 flex items-center bg-secondary rounded-full w-max gap-3 p-0.5 before:absolute before:w-6 before:h-6 before:bg-accent2 before:rounded-full before:left-0 before:translate-x-switch">
        <%= inline_svg_tag("svg/sun.svg", class: "sun fill-text stroke-text z-10", data: { "theme-target": "sun"}) %>
        <%= inline_svg_tag("svg/moon.svg", class: "moon fill-text stroke-text z-10", data: { "theme-target": "moon"}) %>
      </div>
      <%=  %>
      <% if %w(tweets notifications users).include?(params[:controller])  %>
        <%= render "search/form" %>
      <% end %>

      <%# check where the form should go in the many controllers %>
      <%# also, on the search page, it automatically searches for something off the bat. correct that too %>
    </div>

    <dialog id="turbo-confirm">
      <form class="dialog" method="dialog">
        <h3></h3>
        <p></p>
        <div>
          <button value="confirm">Confirm</button>
        </div>
        <div>
          <button value="cancel">Cancel</button>
        </div>
      </form>
    </dialog>
  </body>
</html>
