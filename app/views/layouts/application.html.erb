<!DOCTYPE html>
<html class="preload" lang="en">
  <head>
    <title>OdinTwitter</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_include_tag "application", "data-turbo-track": "reload", defer: true %>
  </head>

  <body class="h-screen bg-background text-text flex justify-center gap-4 duration-500">
    <%= turbo_frame_tag "modal" %>

    <div id="flash" class="flash">
      <%= render "layouts/flash" %>
    </div>

    <div class="access-buttons relative top-24 flex flex-col gap-64 w-56">
      <% if current_user %>
        <div class="access-buttons flex flex-col gap-4 text-xl">
          <%= link_to root_path, class: "group" do %>
              <%= content_tag(:span, "Home", class: "py-2 px-4 rounded-full group-hover:bg-accent2 group-hover:brightness-125 group-hover:ease-in group-hover:duration-500") %>
          <% end %>
          <%= link_to search_path, class: "group" do %>
              <%= content_tag(:span, "Search", class: "py-2 px-4 rounded-full group-hover:bg-accent2 group-hover:brightness-125 group-hover:ease-in group-hover:duration-500") %>
          <% end %>
          <%= link_to notifications_path, class: "group" do %>
              <%= content_tag(:span, "Notifications", class: "py-2 px-4 rounded-full group-hover:bg-accent2 group-hover:brightness-125 group-hover:ease-in group-hover:duration-500") %>
          <% end %>
          <%= link_to messages_path, class: "group" do %>
              <%= content_tag(:span, "Messages", class: "py-2 px-4 rounded-full group-hover:bg-accent2 group-hover:brightness-125 group-hover:ease-in group-hover:duration-500") %>
          <% end %>
          <%= link_to user_bookmarks_path, class: "group" do %>
              <%= content_tag(:span, "Bookmarks", class: "py-2 px-4 rounded-full group-hover:bg-accent2 group-hover:brightness-125 group-hover:ease-in group-hover:duration-500") %>
          <% end %>
          <%= link_to username_path(current_user.username), class: "group" do %>
            <%# maybe try to do the routing different, for the user not to be able to input a username that they want %>
              <%= content_tag(:span, "Profile", class: "py-2 px-4 rounded-full group-hover:bg-accent2 group-hover:brightness-125 group-hover:ease-in group-hover:duration-500") %>
          <% end %>
          <%= link_to settings_account_path(user_id: current_user.id), class: "group" do %>
            <%# maybe try to do the routing different, for the user not to be able to input an id that they want %>
              <%= content_tag(:span, "Settings", class: "py-2 px-4 rounded-full group-hover:bg-accent2 group-hover:brightness-125 group-hover:ease-in group-hover:duration-500") %>
          <% end %>

          <%= turbo_frame_tag "button", data: { turbo_permanent: true } do %>
            <%= link_to new_post_path, data: {turbo_frame: "modal", turbo_action: :advance} do %>
              <%= content_tag(:div, "Compose", class: "compose bg-primary hover:bg-brightness-125 text-white font-bold py-2 px-4 rounded-full text-center duration-500") %>
            <% end %>
          <% end %>
      </div>

        <div>
          <% if current_user.passive_follows.exists?(is_request: true) %>
            <div class="follow-requests"><%= link_to "Follow Requests", notifications_follow_request_path %></div>
          <% end %>

          <div>Logged in as <%= current_user.username if current_user %></div>
          <%= button_to "Sign out", destroy_user_session_path, method: :delete, class: "bg-primary hover:brightness-125 text-white font-bold py-2 px-4 rounded-full duration-500" %>
        </div>
      <% end %>
    </div>

    <%= yield %>

    <div>
      <div class="theme-toggle cursor-pointer relative top-2 flex items-center bg-secondary rounded-full w-max gap-3 p-0.5 before:absolute before:w-6 before:h-6 before:bg-accent2 before:rounded-full before:left-0 before:translate-x-switch duration-500" data-controller="theme">
        <%= inline_svg_tag("svg/sun.svg", class: "sun fill-text stroke-text z-[5] duration-500") %>
        <%= inline_svg_tag("svg/moon.svg", class: "moon fill-text stroke-text z-[5] duration-500") %>
      </div>

      <% if %w(posts notifications users).include?(params[:controller])  %>
        <%= render "search/form" %>
      <% end %>
    </div>

    <dialog id="turbo-confirm">
      <form class="dialog" method="dialog">
        <h3></h3>
        <p></p>
        <div>
          <button value="confirm">Confirm</button>
        </div>
        <div>
          <button value="cancel">Cancel</button>
        </div>
      </form>
    </dialog>
  </body>
</html>
