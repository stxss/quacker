<%= turbo_stream_from "#{@user&.to_gid_param}" %>

<div class="flex m-5">
  <div class="">
    <div class="new-message flex-none w-48">
      <%= link_to "new conversation", new_conversation_path, data: { turbo_frame: "modal", turbo_action: :advance} %>
    </div>

    <div class="">
      <%= render "search/message_form" %>
    </div>

    <div class="messages-list my-5 w-56 truncate ">
      <%= turbo_frame_tag "conversations", data: { turbo_action: :advance }, class: "" do %>
          <% @conversations.ordered.each do |c| %>
            <%= render "conversations/single_conversation_preview", conversation: c %>
          <% end %>
      <% end %>
    </div>
  </div>

  <%= turbo_frame_tag "messages", data: { turbo_frame: "messages", turbo_action: :advance }, class: "flex-col top-0 bottom-0 right-80" do %>
    <div id="message-list" class="flex flex-col w-[45%] h-[89vh] overflow-auto fixed ">
      <%= render "conversations/single_conversation_full", conversation: @conversation %>

      <div id="message-form" class="fixed bottom-[5vh] h-[5vh]">
        <% if @other_user.account.has_blocked?(current_user) %>
          You can no longer send messages to @<%= @other_user.username %> as they have blocked you.
        <% else %>
          <%= render "messages/new", conversation: @conversation %>
        <% end %>
      </div>
    </div>

  <% end %>
</div>
