<% show_view = @show_replies if local_assigns[:show_view].nil? %>

<% if @show_replies || show_view %>
  <% if t.comments.size >= 3  %>
    <%= link_to "Show more replies", single_tweet_path(username: t.author.username, id: t.id), data: {turbo: false} %>
    <% if session[:new_comment] == 1 %>
      <% t.comments[-3..-2].each do |tweet| %>
        <%= render "comments/comment_tweet_info", t: tweet %>
      <% end %>
    <% else %>
      <% t.comments.last(2).each do |tweet| %>
        <%= render "comments/comment_tweet_info", t: tweet %>
      <% end %>
    <% end %>
  <% elsif t.comments.size == 2 && session[:new_comment] == 1 %>
    <%= render "comments/comment_tweet_info", t: t.comments.last(2).first %>
  <% elsif session[:new_comment] == 1 || (!t.new_tweet?(@tweets) && t.just_updated?) %>
  <% elsif (!t.new_tweet?(@tweets) && !t.just_updated?) %>
    <% t.comments.each do |tweet| %>
        <%= render "comments/comment_tweet_info", t: tweet, original: t %>
    <% end %>
  <% end %>
<% else %>
  <% t.comments.each do |tweet| %>
    <%= render "comments/comment_tweet_info", t: tweet, original: t %>
  <% end %>
<% end %>
