<%= turbo_frame_tag "post_#{root.id}" do %>
  <div class="post">
    <% if root.deleted_at %>
      <p>This Post has been deleted.</p>
    <% elsif current_user.account.has_blocked?(root.author.account) %>
      <%= render partial: "blocks/blocked_single_post", locals: { post: root } %>
    <% elsif root.author.account.has_blocked?(current_user) %>
      <%= render partial: "blocks/current_is_blocked_single_post", locals: { post: root } %>
    <% else %>
      <% if root.quote_post? %>
        <%= render partial: "quotes/quote_post_info", locals: { post: root, original: root.original, view: :all_user_posts } %>
      <% else %>
        <%= render partial: "posts/post_info", locals: { post: root, view: :all_user_posts } %>
      <% end %>
    <% end %>

      <% if root != original %>
        <%= turbo_frame_tag "post_#{original.id}" do %>
          <div class="post">
            <% if original.deleted_at %>
              <p>This Post has been deleted.</p>
            <% elsif current_user.account.has_blocked?(original.author.account) %>
              <%= render partial: "blocks/blocked_single_post", locals: { post: original } %>
            <% elsif original.author.account.has_blocked?(current_user) %>
              <%= render partial: "blocks/current_is_blocked_single_post", locals: { post: original } %>
            <% else %>
              <%= render partial: "posts/post_info", locals: { post: original, view: :all_user_posts } %>
            <% end %>

            <%= turbo_frame_tag "post_#{post.id}" do %>
              <div class="post">
                <%= render partial: "posts/post_info", locals: { post: post, view: :all_user_posts } %>
              </div>
            <% end %>
          </div>
        <% end %>
      <% else %>
        <%= turbo_frame_tag "post_#{post.id}" do %>
          <div class="post">
            <%= render partial: "posts/post_info", locals: { post: post, view: :all_user_posts } %>
          </div>
        <% end %>
      <% end %>
  </div>
<% end %>
